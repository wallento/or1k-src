<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Newlib OR1K Support: Timer control</title>

<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css" />

<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>

</head>
<body>
<div id="top"><!-- do not remove this div! -->


<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  
  
  <td style="padding-left: 0.5em;">
   <div id="projectname">Newlib OR1K Support
   
   </div>
   
  </td>
  
  
  
 </tr>
 </tbody>
</table>
</div>

<!-- Generated by Doxygen 1.7.6.1 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Timer control</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga432f34016f4f559c29b0be4fbc87e623">or1k_timer_init</a> (unsigned int hz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#gaf760867d2f9d04f0c101c4c4975b0616">or1k_timer_set_period</a> (uint32_t hz)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga28914de74748e69a61db1ea7eb1ff553">or1k_timer_set_handler</a> (void(*handler)(void))</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#gad50095aee03012b59fc5b6de5e0e9bdf">or1k_timer_set_mode</a> (uint32_t mode)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">uint32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga0e392edcf73b9cf1c0279471ae59d241">or1k_timer_restore</a> (uint32_t sr_tee)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga48cd5b4c0bcc3c0b5ec28326426a66aa">or1k_timer_pause</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga0bbdc374a3d140e538fc32b48b05df47">or1k_timer_reset</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">unsigned long&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga2baa18c5153c793b7d2a85c6e224cea0">or1k_timer_get_ticks</a> (void)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__or1k__timer.html#ga456bc40cdfbbbdfd62c936c065457cc2">or1k_timer_reset_ticks</a> (void)</td></tr>
</table>
<hr/><a name="details" id="details"></a><h2>Detailed Description</h2>
<p>The tick timer can be used for time measurement, operating system scheduling etc. By default it is initialized to continuously count the ticks of a certain period after calling <a class="el" href="group__or1k__timer.html#ga432f34016f4f559c29b0be4fbc87e623">or1k_timer_init()</a>. The period can later be changed using <a class="el" href="group__or1k__timer.html#gaf760867d2f9d04f0c101c4c4975b0616">or1k_timer_set_period()</a>.</p>
<p>The timer is controlled using <a class="el" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable()</a>, <a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable()</a>, <a class="el" href="group__or1k__timer.html#ga0e392edcf73b9cf1c0279471ae59d241">or1k_timer_restore()</a>, <a class="el" href="group__or1k__timer.html#ga48cd5b4c0bcc3c0b5ec28326426a66aa">or1k_timer_pause()</a>. After initialization it is required to enable the timer the first time using <a class="el" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable()</a>. <a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable()</a> only disables the tick timer interrupts, it does not disable the timer counting. If you plan to use a pair of <a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable()</a> and <a class="el" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable()</a> to protect sections of your code against interrupts you should use <a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable()</a> and <a class="el" href="group__or1k__timer.html#ga0e392edcf73b9cf1c0279471ae59d241">or1k_timer_restore()</a>, as it may be possible that the timer interrupt was not enabled before disabling it, enable would then start it unconditionally. <a class="el" href="group__or1k__timer.html#ga48cd5b4c0bcc3c0b5ec28326426a66aa">or1k_timer_pause()</a> pauses the counting.</p>
<p>In the default mode you can get the tick value using <a class="el" href="group__or1k__timer.html#ga2baa18c5153c793b7d2a85c6e224cea0">or1k_timer_get_ticks()</a> and reset this value using <a class="el" href="group__or1k__timer.html#ga456bc40cdfbbbdfd62c936c065457cc2">or1k_timer_reset_ticks()</a>.</p>
<p>Example for using the default mode:</p>
<div class="fragment"><pre class="fragment">   <span class="keywordtype">int</span> main() {
     uint32_t ticks = 0;
     uint32_t timerstate;
     <a class="code" href="group__or1k__timer.html#ga432f34016f4f559c29b0be4fbc87e623">or1k_timer_init</a>(100);
     <a class="code" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable</a>();
     <span class="keywordflow">while</span> (1) {
       <span class="keywordflow">while</span> (ticks == <a class="code" href="group__or1k__timer.html#ga2baa18c5153c793b7d2a85c6e224cea0">or1k_timer_get_ticks</a>()) { }
       timerstate = <a class="code" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable</a>();
       <span class="comment">// do something atomar</span>
       <a class="code" href="group__or1k__timer.html#ga0e392edcf73b9cf1c0279471ae59d241">or1k_timer_restore</a>(timerstate);
       <span class="keywordflow">if</span> (ticks == 100) {
         printf(<span class="stringliteral">&quot;A second elapsed\n&quot;</span>);
         <a class="code" href="group__or1k__timer.html#ga456bc40cdfbbbdfd62c936c065457cc2">or1k_timer_reset_ticks</a>();
         ticks = 0;
       }
     }
   }
</pre></div> <hr/><h2>Function Documentation</h2>
<a class="anchor" id="gab40473a360aa82273575cdbc4381ac93"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_disable" ref="gab40473a360aa82273575cdbc4381ac93" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint32_t <a class="el" href="group__or1k__timer.html#gab40473a360aa82273575cdbc4381ac93">or1k_timer_disable</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Disable timer interrupt</p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Status of timer interrupt before call </dd></dl>

</div>
</div>
<a class="anchor" id="ga369138d63850f2a4dfe216315c31f3d4"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_enable" ref="ga369138d63850f2a4dfe216315c31f3d4" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga369138d63850f2a4dfe216315c31f3d4">or1k_timer_enable</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Enable timer interrupt </p>

</div>
</div>
<a class="anchor" id="ga2baa18c5153c793b7d2a85c6e224cea0"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_get_ticks" ref="ga2baa18c5153c793b7d2a85c6e224cea0" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned long <a class="el" href="group__or1k__timer.html#ga2baa18c5153c793b7d2a85c6e224cea0">or1k_timer_get_ticks</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Get timer ticks </p>

</div>
</div>
<a class="anchor" id="ga432f34016f4f559c29b0be4fbc87e623"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_init" ref="ga432f34016f4f559c29b0be4fbc87e623" args="(unsigned int hz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int <a class="el" href="group__or1k__timer.html#ga432f34016f4f559c29b0be4fbc87e623">or1k_timer_init</a> </td>
          <td>(</td>
          <td class="paramtype">unsigned int&#160;</td>
          <td class="paramname"><em>hz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Initialize tick timer</p>
<p>This initializes the tick timer in default mode (see <a class="el" href="group__or1k__timer.html">Timer control</a> for details).</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">hz</td><td>Initial period of the tick timer </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>0 if successful, -1 if timer not present </dd></dl>

</div>
</div>
<a class="anchor" id="ga48cd5b4c0bcc3c0b5ec28326426a66aa"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_pause" ref="ga48cd5b4c0bcc3c0b5ec28326426a66aa" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga48cd5b4c0bcc3c0b5ec28326426a66aa">or1k_timer_pause</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Pause timer counter </p>

</div>
</div>
<a class="anchor" id="ga0bbdc374a3d140e538fc32b48b05df47"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_reset" ref="ga0bbdc374a3d140e538fc32b48b05df47" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga0bbdc374a3d140e538fc32b48b05df47">or1k_timer_reset</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reset timer counter </p>

</div>
</div>
<a class="anchor" id="ga456bc40cdfbbbdfd62c936c065457cc2"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_reset_ticks" ref="ga456bc40cdfbbbdfd62c936c065457cc2" args="(void)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga456bc40cdfbbbdfd62c936c065457cc2">or1k_timer_reset_ticks</a> </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Reset timer ticks </p>

</div>
</div>
<a class="anchor" id="ga0e392edcf73b9cf1c0279471ae59d241"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_restore" ref="ga0e392edcf73b9cf1c0279471ae59d241" args="(uint32_t sr_tee)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga0e392edcf73b9cf1c0279471ae59d241">or1k_timer_restore</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sr_tee</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Restore timer interrupt status</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">sr_tee</td><td>Status of timer interrupt </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="ga28914de74748e69a61db1ea7eb1ff553"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_set_handler" ref="ga28914de74748e69a61db1ea7eb1ff553" args="(void(*handler)(void))" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#ga28914de74748e69a61db1ea7eb1ff553">or1k_timer_set_handler</a> </td>
          <td>(</td>
          <td class="paramtype">void(*)(void)&#160;</td>
          <td class="paramname"><em>handler</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Replace the timer interrupt handler</p>
<p>By default the tick timer is used to handle timer ticks. The user can replace this with an own handler for example when implementing an operating system.</p>
<dl class="params"><dt><b>Parameters:</b></dt><dd>
  <table class="params">
    <tr><td class="paramname">handler</td><td>The callback function pointer to the handler </td></tr>
  </table>
  </dd>
</dl>

</div>
</div>
<a class="anchor" id="gad50095aee03012b59fc5b6de5e0e9bdf"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_set_mode" ref="gad50095aee03012b59fc5b6de5e0e9bdf" args="(uint32_t mode)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#gad50095aee03012b59fc5b6de5e0e9bdf">or1k_timer_set_mode</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>mode</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set timer mode</p>
<p>The timer has different modes (see architecture manual). The default is to automatically restart counting (SPR_TTMR </p>

</div>
</div>
<a class="anchor" id="gaf760867d2f9d04f0c101c4c4975b0616"></a><!-- doxytag: member="or1k&#45;support.h::or1k_timer_set_period" ref="gaf760867d2f9d04f0c101c4c4975b0616" args="(uint32_t hz)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="group__or1k__timer.html#gaf760867d2f9d04f0c101c4c4975b0616">or1k_timer_set_period</a> </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>hz</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Set period of timer</p>
<p>Set the period of the timer to a value in Hz. The frequency from the board support package is used to determine the match value. </p>

</div>
</div>
</div><!-- contents -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>



<hr class="footer"/><address class="footer"><small>
Generated on Tue Apr 22 2014 10:09:31 for Newlib OR1K Support by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.7.6.1
</small></address>

</body>
</html>
